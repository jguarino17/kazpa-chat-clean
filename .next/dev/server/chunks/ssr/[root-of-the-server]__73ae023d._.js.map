{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/joey/kazpagpt/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\n\ntype Message = {\n  role: \"user\" | \"assistant\";\n  content: string;\n};\n\nexport default function Home() {\n  const [messages, setMessages] = useState<Message[]>([\n    {\n      role: \"assistant\",\n      content:\n        \"Welcome to kazpaGPT.\\nAsk anything about kazpa — setup, software, risk, FAQs, or how to get started.\",\n    },\n  ]);\n\n  const [input, setInput] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  // ✅ Always-accurate copy of messages (prevents stale-state bugs)\n  const messagesRef = useRef<Message[]>(messages);\n  useEffect(() => {\n    messagesRef.current = messages;\n  }, [messages]);\n\n  // Auto-scroll\n  const bottomRef = useRef<HTMLDivElement | null>(null);\n  useEffect(() => {\n    bottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages, loading]);\n\n  async function sendMessage() {\n    const text = input.trim();\n    if (!text || loading) return;\n\n    const userMessage: Message = { role: \"user\", content: text };\n\n    // ✅ Build nextMessages synchronously from ref (always current)\n    const nextMessages = [...messagesRef.current, userMessage];\n\n    // Update UI immediately\n    setMessages(nextMessages);\n    setInput(\"\");\n    setLoading(true);\n\n    try {\n      const res = await fetch(\"/api/chat\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ messages: nextMessages }),\n      });\n\n      const data = await res.json();\n\n      const botMessage: Message = {\n        role: \"assistant\",\n        content: String(data?.reply || \"Something went wrong.\"),\n      };\n\n      setMessages((prev) => [...prev, botMessage]);\n    } catch (err) {\n      setMessages((prev) => [\n        ...prev,\n        { role: \"assistant\", content: \"Something went wrong. Please try again.\" },\n      ]);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  return (\n    <main className=\"flex h-screen flex-col bg-[#0b0f14] text-white\">\n      {/* Header */}\n      <div className=\"border-b border-white/10 px-6 py-4\">\n        <h1 className=\"text-lg font-semibold\">kazpaGPT</h1>\n        <p className=\"text-sm text-white/50\">The AI brain of kazpa</p>\n      </div>\n\n      {/* Messages */}\n      <div className=\"flex-1 overflow-y-auto px-6 py-8\">\n        <div className=\"mx-auto max-w-3xl space-y-4\">\n          {messages.map((msg, i) => (\n            <div\n              key={i}\n              className={`rounded-xl p-4 text-sm leading-relaxed whitespace-pre-wrap ${\n                msg.role === \"assistant\" ? \"bg-white/5\" : \"bg-blue-500/20 ml-auto\"\n              }`}\n            >\n              {msg.content}\n            </div>\n          ))}\n\n          {loading && (\n            <div className=\"rounded-xl bg-white/5 p-4 text-sm text-white/50\">\n              kazpaGPT is thinking…\n            </div>\n          )}\n\n          <div ref={bottomRef} />\n        </div>\n      </div>\n\n      {/* Input */}\n      <div className=\"border-t border-white/10 p-4\">\n        <div className=\"mx-auto flex max-w-3xl items-center gap-3 rounded-xl bg-white/5 px-4 py-3\">\n          <input\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" && !e.shiftKey) {\n                e.preventDefault();\n                sendMessage();\n              }\n            }}\n            placeholder=\"Ask kazpaGPT anything...\"\n            className=\"flex-1 bg-transparent text-sm outline-none placeholder:text-white/40\"\n            disabled={loading}\n          />\n          <button\n            onClick={sendMessage}\n            className=\"text-sm text-white/70 hover:text-white disabled:opacity-40\"\n            disabled={loading || !input.trim()}\n          >\n            Send\n          </button>\n        </div>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AASe,SAAS;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAY;QAClD;YACE,MAAM;YACN,SACE;QACJ;KACD;IAED,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,iEAAiE;IACjE,MAAM,cAAc,IAAA,+MAAM,EAAY;IACtC,IAAA,kNAAS,EAAC;QACR,YAAY,OAAO,GAAG;IACxB,GAAG;QAAC;KAAS;IAEb,cAAc;IACd,MAAM,YAAY,IAAA,+MAAM,EAAwB;IAChD,IAAA,kNAAS,EAAC;QACR,UAAU,OAAO,EAAE,eAAe;YAAE,UAAU;QAAS;IACzD,GAAG;QAAC;QAAU;KAAQ;IAEtB,eAAe;QACb,MAAM,OAAO,MAAM,IAAI;QACvB,IAAI,CAAC,QAAQ,SAAS;QAEtB,MAAM,cAAuB;YAAE,MAAM;YAAQ,SAAS;QAAK;QAE3D,+DAA+D;QAC/D,MAAM,eAAe;eAAI,YAAY,OAAO;YAAE;SAAY;QAE1D,wBAAwB;QACxB,YAAY;QACZ,SAAS;QACT,WAAW;QAEX,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,aAAa;gBACnC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,UAAU;gBAAa;YAChD;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,MAAM,aAAsB;gBAC1B,MAAM;gBACN,SAAS,OAAO,MAAM,SAAS;YACjC;YAEA,YAAY,CAAC,OAAS;uBAAI;oBAAM;iBAAW;QAC7C,EAAE,OAAO,KAAK;YACZ,YAAY,CAAC,OAAS;uBACjB;oBACH;wBAAE,MAAM;wBAAa,SAAS;oBAA0C;iBACzE;QACH,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,8OAAC;QAAK,WAAU;;0BAEd,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAwB;;;;;;kCACtC,8OAAC;wBAAE,WAAU;kCAAwB;;;;;;;;;;;;0BAIvC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;wBACZ,SAAS,GAAG,CAAC,CAAC,KAAK,kBAClB,8OAAC;gCAEC,WAAW,CAAC,2DAA2D,EACrE,IAAI,IAAI,KAAK,cAAc,eAAe,0BAC1C;0CAED,IAAI,OAAO;+BALP;;;;;wBASR,yBACC,8OAAC;4BAAI,WAAU;sCAAkD;;;;;;sCAKnE,8OAAC;4BAAI,KAAK;;;;;;;;;;;;;;;;;0BAKd,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,OAAO;4BACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;4BACxC,WAAW,CAAC;gCACV,IAAI,EAAE,GAAG,KAAK,WAAW,CAAC,EAAE,QAAQ,EAAE;oCACpC,EAAE,cAAc;oCAChB;gCACF;4BACF;4BACA,aAAY;4BACZ,WAAU;4BACV,UAAU;;;;;;sCAEZ,8OAAC;4BACC,SAAS;4BACT,WAAU;4BACV,UAAU,WAAW,CAAC,MAAM,IAAI;sCACjC;;;;;;;;;;;;;;;;;;;;;;;AAOX"}},
    {"offset": {"line": 213, "column": 0}, "map": {"version":3,"sources":["file:///Users/joey/kazpagpt/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0]}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///Users/joey/kazpagpt/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":["file:///Users/joey/kazpagpt/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0]}}]
}